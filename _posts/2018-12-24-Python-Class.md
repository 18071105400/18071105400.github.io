---
layout: post
title: "Python-20-class"
categories: Python
tags: class
author: worren li &emsp;

---

* centent
{:toc}

# Python  
# 1.面向对象编程 Ojbect-Oriented Programming
* 两种编程思想:  
    1. 面向过程编程  
      * 最小单位是: 函数 function  
    2. 面向对象的编程:  
      * 最小单位是: 类 class  

## 1. 什么是对象:  
   * 对象是指现实中的物体或实体  

## 2.什么是面向对象  
   把一切看成对象(实例) 用各种对象之间的关系来描述事物  

### * 对象都有什么特征:
  1. 对象有很多的属性(名词,形容词)  
     姓名, 年龄, 性别, 头发颜色  
   2. 对象有很多行为(动作,动词)  
    学习,吃饭,睡觉,踢球,工作  

## 3.什么是类  
   * 拥有相同属性和行为的对象分为一组,即为一个类  
   * 类是用来描述对象的工具,用类可以创建此类的对象(实例)  
```
示意:
  车(类)  ---->  BYD E6(京A.88888)  实例
         \
          \-->  BMW X5(京B.00000)  对象(实例)

  狗(类) ----> 小京巴(户籍号: 000001) 对象
        \
         \---> 导盲犬(户籍号:00002)  对象

  int(类)  -----> 100 对象
           \
            \---> 200 对象
```

### 1.类的创建语句:
1. 语法:
```
    class 类名(继承列表):
        '''类的文档字符串'''
        实例方法(类内的函数method)定义
        类变量
        类方法(@classmethod)
        静态方法(@staticmethod) 
```
2. 作用  
    创建一个类  
    类用于描述对象的行为和属性  
    类用于创建此类的一个或多个对象(实例)  
3. 说明  
    类名必须是标识符  
    类名实质是变量,它绑定一个类  

### 2.构造函数
1. 格式:  
    类名([传参列表])  
2. 作用:  
    创建这个类的实例对象,并返回此实例对象的引用关系  

3. 说明:
   * 对象(实例)可以调用类方法和实例方法
   * 对象(实例) 有自己的作用域和名字空间,可以为该实例添加实例变量(也叫实例属性)


## 4.实例方法(instance method)
```
  定义格式:
    class 类名(继承列表):
        def 实例方法名(self, 参数1, 参数2, ...):
            '''方法的文档字符串'''
            语句块
```
1. 作用:  
    用于描述一个对象的行为,让此类型的全部对象都拥有相同的行为  
2. 说明:  
    实例方法的实质是函数,是定义在内类的函数  
    实例方法至少有一个形参,第一个形参绑定调用此方法的实例,一般命名为'self'  
3. 实例方法的调用语法:  
   实例.实例方法名(调用传参)  
   或  
   类名.实例方法名(实例, 调用传参)  

## 5.实例属性 attribute (也叫实例变量)
   每个实例可以用自己的变量来记录每个对象自己的数据,这个变量称为实例变量  

1. 使用语法:  
    实例.属性名  

2. 赋值规则:  
    首次为属性赋值则创建此属性  
    再次为属性赋值则改变此属性的绑定关系  
3. 作用:
    记录每个对象自身的数据
```
练习:
  定义一个"人" 类 
    class Human:
        def set_info(self, name, age,
                    address="不详"):
            ... 此处自己实现
        def show_info(self):
            '''此处显示人此的信息'''
            ... 此处自己实现
    s1 = Human()
    s1.set_info('小张', 20, '北京市东城区')
    s2 = Human()
    s2.set_info('小李', 18)
    s1.show_info()  # 小张 今年 20 岁,家住: ...
    s1.show_info()  # 小李 今年 18 岁,家住: 不详
```

4. 删除属性:  
   del 语句    
   del 对象.实例变量名  
  
5. del 语句总结:  
   1)  删除变量         del a,b,c  
   2)  删除列表中的元素  del L[0], L[0:3]  
   3)  删除字典中的键    del d['name']  
   4)  删除属性         del obj.name  


## 6.初始化方法
1. 作用:  
    对新创建的对象添加属性  
2.  语法格式:
```
    class 类名(继承列表):
        def __init__(self [,形参列表])
            语句块
    注:[]代表其中的内容可省略
```
3. 说明:  
    1. 初始化方法的名必须是 '__init__' 不可改变  
    2. 初始化方法会在构造函数创建实例后自动调用,且将实例自身通过第一个参数self传入'__init__' 方法  
    3. 构造函数的实参将通过__init__方法的参数列表传入到__init__方法中  
    4. 初始化方法内如果需要return 返回,则必须返回None  

## 7.析构方法
1.  格式:
```
    class 类名(继承列表):
        def __del__(self):
            ....
```
2. 作用:  
    在此对象销毁前释放此对象所占用的资源  
3. 说明:
    析构方法在对象被销毁前被自动调用python语言，建议不要在对象销毁时做任何事情,因为销毁的时间难以确定

## 8.预置实例属性  
1.  __dict__ 属性   
    __dict__属性绑定一个存储此实例自身变量的字典  
```
  示例:
    class Dog:
        pass
    dog1 = Dog()
    print(dog1.__dict__)  # {}
    dog1.color = "白色"
    print(dog1.__dict__)  # {'color': "白色"}
```

2. __class__ 属性  
     __class__ 属性绑定创建此实例的类  

*  作用:  
    可以借助于此属性来访问创建此实例的类
```
  示例:
    class Dog:
       pass
    dog1 = Dog()
    print(dog1.__class__)
    dog2 = dog1.__class__()  #  Dog()
```

## 9.用于实例对象的函数:
   isinstance(obj, class_or_tuple)  返回这个对象obj是否是某个类的对象,或者某些类中一个类的对象.如果是则返回True,否则返回False 
   type(obj)  返回对象的类型  
```
  示例:
    class Dog:
        pass
    dog1 = Dog()
    isinstance(dog1, Dog)  # True
    isinstance([1,2,3], Dog)  # False
    isinstance([1, 2, 3], (int, str))  # False
    isinstance([1, 2, 3], (int, str, list))#True
    type(dog1) is Dog  # True
```

# 2.类
```
    定义方法:
      class 类名:
          ...
  类也是对象,它是能创建实例的对象
```
## 1. 类变量  
   类变量是类的属性，此属性属于类，不属于此类的实例  
1. 作用:  
    通常用来存储该类创建的对象的共有属性  
2.  说明:  
    类变量可以通过该类直接访问  
    类变量可以通过类的实例直接访问(取值)  
    类变量可以通过此类的对象的__class__属性间接访问  

## 2.实例方法和类方法都是类的变量(类变量)


## 3.类的文档字符串:  
   类内第一个没有赋值给任何变量的字符串为类的文档字符串  
   类的文档字符串绑定在类的 __doc__ 属性上  
```
  示例:
    class Dog:
        '''Dog类的文档字符串'''
    
    >>> help(Dog)
    >>> print(Dog.__doc__)
```
## 4.类的 __slots__ 列表:
1. 作用:
    限定一个类创建的实例只能在固定的属性(实例变量)不允许对象添加此列表以外的实例属性,访问用户因错写属性名而发生程序错误
2. 说明:
    __slots__属性是一个列表,列表的值是字符串含有__slots__属性的类所创建的实例对象没有__dict__属性,即此实例不用字典来存储实例属性

## 5.类方法 @classmethod
   类方法是用于描述类的行为的方法,类方法属于类,不属于该类创建的对象

* 说明:  
    1. 类方法需要使用@classmethod 装饰器定义  
    2. 类方法至少有个一个形参,第一个形参用于绑定类,约定写为'cls'  
    3. 类和该类的实例都可以调用类方法  
    4. 类方法不能访问此类创建的对象的实例属性  

## 6.静态方法 @staticmethod
   静态方法是定义在类内的函数,此函数的作用域是类的内部  

* 说明:  
    1. 静态方法需要使用@staticmethod 装饰器定义  
    2. 静态方法与普通函数定义相同,不需要传入self和cls参数  
    3. 静态方法只能凭借该类或类的实例调用  
    4. 静态方法不能访问类变量和实例变量  

## 7.函数,静态方法, 类方法, 实例方法:
   共性:
    语句块,实现相应的功能

## 8.继承 inheritnce 和 派生 derived
1. 什么是继承／派生  
    派生就是从一个已有的类中衍生成新类  
    继承是指在衍生出的新类中的对象会拥有原类的属性和行为  
2. 作用:  
    用继承派生机制，可以将一些共有功能加在基类中，实现代码共享，在不改变基类代码的基础上，改变原有类的功能  
3.  名词:  
    基类(base class)/超类(super class)/父类(father class)  
    派生类(derived class) / 子类(child class)  

### 1.单继承:
1. 语法:
    class 类名(基类名):  
        语句块  
2. 说明:  
    单继承是指派生类由一个基类衍生出来的类  

3. 继承说明:  
   python3中任何类都直接或间接的继承自object类
   object类是一切类的超类

4. 类的__base__属性  
   __base__ 属性用来记录此类的基类  

5. python内建类的继承关系见:   
  >>> help(__builtins__)   

### 2.覆盖 overridde  

* 覆盖是指在有继承关系的类中．子类中实现了与基类同名的方法，在子类的实例调用该方法时，实际调用的是子类的覆盖版本，这种现象叫做覆盖  

1. 作用:  
    实现和父类同名，但功能不同的方法  

2. 问题:
  当覆盖发生时, 如何调用父类的被覆盖方法？

3. super函数  
   super(cls, obj) 返回绑定超类的实例(要求obj必须是cls 类或cls子类的对象)
   super()   返回绑定超类的实例，等同于:
      super(__class__, 实例方法的第一个参数),必须用在方法内调用
4. 作用:  
    借助super() 返回的实例间接调用父类的覆盖方法  

5. super的应用
* 显式调用基类的初始化方法  
   当子类中实现了__init__方法，基类的__init__方法将不会被自动调用.如果需要调用，则需要用super显式调用.  

## 用于类的函数:
* issubclass(cls, class_or_tuple) 判断一个类是否继承自某个类 class 或某些类tuple中的一个类,如果是则返回True,否则返回False
```
  示例:
    class A:
        pass
    class B(A):
        pass
    class C(B):
        pass
    issubclass(C, B) # True
    issubclass(bool, int)  # True
    issubclass(str, (A, B, int, float))  # False
    issubclass(str, (A, B, int, object)) # True
```

## 面向对象编程语言的特征:
  继承
  封装
  多态
## 封装 
* 封装是指隐藏类的实现细节,让使用者不关心这些细节，封装的目的是让使用者通过尽可能少的方法(或属性)操作对象

### 私有属性和方法
* python类中以双下划线__开头,不以双下划线结尾的标识，符为私有成员,私有成员只能使用该类的方法进行访问和修改


## 多态 polymorphic
* 字面意思: '多种状态'

### 编程语言的状态:
* 静态(编译时状态)  # C/C++
* 动态(运行时状态)  # C++/Java

### 多态原指在有继承关系的类中,调用基类对象的方法,实际能
* 调用到子类覆盖方法的现象叫多态
* 说明:
    python全部的对象都只有'运行时状态(动态)',没有C++语言里的编译时状态(静态)

## 多继承 multiple inheritance  
* 多继承是指一个子类继承自两个或两个以上的基类  

### 1.多继承是的语法:
```
    class 类名(基类名1, 基类名2, ...):
        语句
```
* 说明:
    1. 一个子类同时继承自多个父类,父类中的方法可以同时被继承下来
    2. 如果两个父类中有同名的方法,而在子类中又没有覆盖此方法时,调用结果难以确定

### 2.多继承的问题(缺陷)
  标识符(名字空间) 冲突的问题要谨慎使用多继承

### 3.多继承的MRO(Method Resolution Order) 问题
    MRO --> 方法的解决(查找)顺序
    类的 __mro__属性用来记录类的方法的查找顺序

### 4.对象转字符串函数的使用
    * repr(obj) 返回一个附合python语法规则的字符串,
    * 通常:
         eval(repr(obj)) == obj
         str(obj)  通过给定的对象返回一个字符串(这个字符串通常是给人阅读的)

* 说明:
    以上两个函数返回的一定是个字符串

## 函数重写
* 函数重写是指在自定义的类内添加相应的方法,让自定义的类创建的实例可以像内建对象一样进行函数操作

* 对象转字符串函数的重写方法
```
  repr(obj) 函数的重写方法:
      def __repr__(self):
          return '字符串'
  str(obj)  函数的重写方法:
      def __str__(self):
          return '字符串'
```
```
str(obj) 函数调用方法说明:
  1. 先调用obj.__str__() 方法取值.
  2. 如果obj.__str__()方法不存在,则调
     用obj.__repr__() 方法取值
  3. 如果再不存在obj.__repr__()方法.则调用object
     类的__repr__方法取值.
```

内建函数重写

```
  方法名                函数名
 __abs__(self)      abs(obj) 函数
 __len__(self)      len(obj) 函数
 __reversed__(self) reversed(obj)
 __round__(self)    round(obj)
```

数值转换函数重写
```
   方法名                 函数名
  __complex__(self)      complex(obj)
  __int__(self)          int(obj)
  __float__(self)        float(obj)
  __bool__(self)         bool(obj)
```

布尔测试函数bool(obj) 函数重写
* 作用:
    1. 用于bool(obj) 函数取值:  
    2. 用于if语句的真值表达式中  
    3. 用于while语句的真值表达式中  
* 说明:
    1. 优先调用obj.__bool__() 方法进行取值
    2. 当不存在obj.__bool__() 方法时,用 obj.__len__() 的返回值是否为零来测定布尔值
    3. 当不存在__len__() 方法时,则直接返回True

## 对象的属性管理函数
1. getattr(obj, name[, default])
    从一个对象得到对象的属性；getattr(x, 'y') 等同于x.y;
    当属性不存在时,如果给出default参数,则返回default,如果没有给出default 则产生一
个AttributeError错误

2. hasattr(obj, name) 用给定的name返回对象obj是否有此属性,此种做法可以避免在
getattr(obj, name)时引发错误

3. setattr(obj, name, value) 给对象obj的名为name的属性设置相应的值value, set(x, 'y', v) 等同于 x.y = v

4. delattr(obj, name) 删除对象obj中的name属性,delattr(x, 'y') 等同于 del x.y